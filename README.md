# BankingProductRecommendation-GNN
Graph Neural Network model for banking products recommendation
# Highlights 
- This is a Graph Neural Network (GNN) model for recommending banking products to customers of a bank. Heterogenous Graph Transformer (HGT) is used in the core model design with customers, products and accounts as nodes and  customer interactions as edges 
- Heterogenous Graph Transformer (HGT) model architecture comprises embedding layer, attention layer and a prediction layer and the key hyper-parameters used are as follows:
  - Embedding dim (n_dim) = 128
  - Staked layers (num_layers) = 2
  - Attention heads (num_heads) = 8
  The above could be improved further for better performance of the model
- The model has 388,901 parameters in total (Node embedding – 3328, Attention layers –   302,624, Prediction layers – 82,949 parameters) 
- Training data is generated synthetically with 100K customers, 200K accounts, 42 products and 300K interactions (edges). Effort has been taken to ensure the synthetic data is representative of the actual production data to the extent possible 
- The model is trained on self-supervised training methodology with 100 epochs and yielded an AUC score of 0.72. Considering the model is trained with limited resources, the training was stopped and the score could be further improved with more epochs and/or tweaking hyper-parameters 
- Retail portfolio of the bank is considered for the model. Bank’s Customers, Products and Accounts are considered as ‘nodes’ and the link between them is considered for the ‘edges’. The objective of the model is to cross-sell and recommend suitable products to existing customers based on their behaviour, products already held and interactions with the bank  
# Data
- Training data is generated synthetically and all efforts have been taken to ensure the synthetic data is representative of the actual production data 
- Master data used – Master data like customer segment, city, customer risk, customer gender, product type etc is prepared manually with values taken to resemble a typical large retail bank. This data is used in generation of customers, accounts, products and interactions  
- A total of 100K customers, 200K accounts, 43 products and 300K interactions. Interactions represent the customer’s queries, views etc of the bank’s products, services, branch visit etc that is critical to understand the preferences of the customer. 
- The model is self-supervised, hence the same data mentioned above is used as training and testing data. Test data is generated by dropping the edges during the training and predicting the same
# Product recommendation methodology
- The product recommendations to the customer, at the end of the model training, is based on the learned embeddings of customer’s own features, customers interaction with products, accounts and messages aggregated from neighbouring nodes via attention, expressed in the form a ‘score’ which is a probability of customer liking the product. Top 5 recommendations for each customer can be arrived at.
# Results & Conclusion 
- Top 5 recommendations of for few customers were checked and found to be logical, though no follow-up is possible due to synthetic data.  
- The model can be trained with actual production data and improved model hyper-parameters to make it production-quality model 
- The model needs to be complemented with UI and other components to push the recommendations to customers through mobile app, bank website login, email and SMS (not part of this notebook)
# Notebook
- Notebook Name : “Banking_Cross-Sell_Prod_Recommendation.ipynb”
  - Type of notebook - Colab
  - Upload ‘MasterData.xlsx’ 
  - Generate customer, product, account and interactions data for training and testing 
  - Execute the model and generate recommendations for few customers. 

